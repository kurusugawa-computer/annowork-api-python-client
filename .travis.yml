dist: focal
language: python
jobs:
  include:
    - name: Run test
      python: 3.8
      script:
        - poetry run pytest tests/test_local_*.py
    - name: Run test
      python: 3.9
      script:
        - poetry run pytest tests/test_local_*.py
    - name: Run test
      python: 3.10
      script:
        - poetry run pytest tests/test_local_*.py
    - name: Run test and lint
      python: 3.11
      script:
        # 最新バージョンではlintも実行する
        - make lint
        - poetry run pytest tests/test_local_*.py

install:
  - pip install pip --upgrade
  - pip install "poetry<1.5"
  - travis_retry poetry install --only main,linter,test

before_script:
  - export TZ=Asia/Tokyo
  - sudo ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime
  - echo "Asia/Tokyo" > sudo tee /etc/timezone  > /dev/null

branches:
  only:
    - main
cache: pip
